

<div ng-controller="minero">
    <table width="893" border="0" cellspacing="0" cellpadding="0" style="font-family: Arial, Helvetica, sans-serif; font-size: 13px; ">
        <tbody>
            <tr>
                <td height="32" align="center" valign="middle" bgcolor="#dee4e9" colspan="2">
                    <span class="band">Consulta de información</span>
                </td>
            </tr>
            <tr>
                <td class="tdheight" height="15px" bgcolor="#ffffff" colspan="2"></td>
            </tr>
            <tr>
                <td align="left" valign="middle" bgcolor="#ffffff" colspan="2">
                    <span class="texto">Variable:</span>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <select ng-model="vari" ng-change="getSectores(vari)" ng-options="v.descripcion for v in variables track by v.id_variable" style="width:300px"></select>
                </td>
            </tr>
            <tr>
                <td class="tdheight" height="15px" bgcolor="#ffffff" colspan="2"></td>
            </tr>
            <tr>
                <td align="center" valign="middle" bgcolor="#dee4e9" colspan="2">
                    <span class="band">Actividad económica</span>
                </td>
            </tr>
            <tr>
                <td class="tdheight" height="15px" bgcolor="#ffffff" colspan="2"></td>
            </tr>
            <tr>
                <td align="left" valign="middle" bgcolor="#ffffff">
                    <span class="texto">Sector SCIAN:</span>
                </td>
                <td align="left" valign="middle" bgcolor="#ffffff">
                    <span class="texto">Actividad económica:</span>
                </td>
            </tr>
            <tr>
                <td align="left" valign="middle" bgcolor="#ffffff">
                    <select ng-model="sec" ng-change="getActividad(sec)" ng-options="v.id_variable + ' '+v.descripcion for v in sectores " style="width: 300px;"></select>
                </td>
                <td align="left" valign="middle" bgcolor="#ffffff">
                    <select ng-model="act" ng-disabled="sec.id_variable==''" ng-options="v.id_variable+' '+v.descripcion for v in actividades " style="width: 300px;"></select>

                </td>
            </tr>
            <tr>
                <td class="tdheight" height="15px" bgcolor="#ffffff" colspan="2"></td>
            </tr>
            <tr>
                <td align="left" valign="middle" bgcolor="#ffffff" colspan="2">
                    <span class="texto">Tipo de dato:</span>
                </td>
            </tr>
            <tr>
                <td align="left" valign="middle" bgcolor="#ffffff" colspan="2">
                    <select ng-model="tipoDat" ng-options=" t.nombre for t in tipo_datos " style="width: 300px;"></select>
                </td>
            </tr>
            <tr>
                <td class="tdheight" height="15px" bgcolor="#ffffff" colspan="2"></td>
            </tr>
            <tr>
                <td align="center" valign="middle" bgcolor="#dee4e9" colspan="2">
                    <span class="band">Periodo:</span>
                </td>
            </tr>
            <tr>
                <td class="tdheight" height="15px" bgcolor="#ffffff" colspan="2"></td>
            </tr>
            <tr>
                <td align="left" valign="middle" bgcolor="#ffffff">
                    <span class="texto">Año:</span>
                </td>
                <td align="left" valign="middle" bgcolor="#ffffff">
                    <span class="texto">Mes:</span>
                </td>
            </tr>
            <tr>
                <td align="left" valign="middle" bgcolor="#ffffff">
                    <select ng-model="anio" ng-options="an.anio for an in aniosMinCon"></select>
                </td>
                <td align="left" valign="middle" bgcolor="#ffffff">
                    <select ng-model="mes" ng-options=" m.nombre for m in meses " style="width: 100px;"></select>
                </td>
            </tr>

            <tr ng-show="datosMin=='ERR'" >
                <td colspan="2" class=" tdheight" align="center" valign="middle" bgcolor="#FFFFFF">
                    <span id="lbError" style="color:Red;">No se encontraron registros con los parámetros establecidos</span>
                </td>
            </tr>
            <tr>

                <td align="center" valign="middle" bgcolor="#f0f0f0" colspan="2">
                    <input name="btnConsulta" id="btnConsulta" type="submit" ng-click="consulta()" value="Ver consulta">
                </td>
            </tr>
            <tr>
                <td align="left" class="tdheight" height="15px" valign="middle" bgcolor="#ffffff" colspan="2"></td>
            </tr>
            <tr>
                <td align="center" valign="middle" bgcolor="#dee4e9" colspan="2">
                    <span class="band">Indicadores de precisión estadística:</span>
                </td>
            </tr>


            <tr>
                <td class="tdheight" height="15px" bgcolor="#ffffff" colspan="2"></td>
            </tr>
            <tr>

                <td align="center" valign="middle" bgcolor="#f0f0f0" colspan="2">
                    <input name="Descargar" id="Descargar" onclick="descargarFile()" type="submit" value="Descargar">
                </td>
            </tr>

        </tbody>
    </table>
    <table></table>
    <div ng-hide="datosMin=='' || datosMin=='ERR'" ng-init="datosMin=''">
        <div id="divCuadro" style="width: 880px; height: 890px; overflow: scroll;">
            <table>
                <tbody>
                    <tr>
                        <td colspan="3">
                            <span class="encabezadoINEGI" style="color: rgb(0, 102, 153); font-family: Arial, Helvetica, sans-serif; font-size: 10pt;">INEGI. Encuesta Mensual de Servicios</span>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <span class="encabezado" style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 10pt;">Índice (base 2008=100) de ingresos por la prestación del servicio según sector y dominio</span>
                        </td>
                    </tr>
                </tbody>
            </table>

            <table cellspacing="0" cellpadding="4" id="datos" ng-show="datosMin.length>0" style="font-family: Arial, Helvetica, sans-serif; font-size: 13px; ">
                <tbody>
                    <tr>
                        <td style="border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: rgb(242, 242, 242) rgb(242, 242, 242) rgb(242, 242, 242) currentColor; border-image: none; text-align: center;" bgcolor="#c6c1ff" rowspan="2">Sector/dominio</td>
                        <td style="border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: rgb(242, 242, 242) rgb(242, 242, 242) rgb(242, 242, 242) currentColor; border-image: none; text-align: center;" bgcolor="#c6c1ff" rowspan="2">Descripción</td>
                        <td style="border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: rgb(242, 242, 242) rgb(242, 242, 242) rgb(242, 242, 242) currentColor; border-image: none; text-align: center; font-family: Arial, Helvetica, sans-serif; font-size: 8pt;" bgcolor="#c6c1ff" colspan="{{colAnios}}" ng-repeat="a in aniosMin">{{a}}</td>
                    </tr>
                    <tr>
                        <td style="border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: rgb(242, 242, 242) rgb(242, 242, 242) rgb(242, 242, 242) currentColor; border-image: none; text-align: center; font-family: Arial, Helvetica, sans-serif; font-size: 8pt;" bgcolor="#c6c1ff" ng-repeat="m in mesesConsulta">{{m.nombre}}</td>
                    </tr>

                    <tr ng-repeat="x in datosMin track by $index">
                        <td class="tdDat" ng-repeat="i in x track by $index" ng-hide="i==''">{{i}}</td>
                    </tr>

                </tbody>
            </table>
            <table width="893" class="tabla" style="font-family: Arial, Helvetica, sans-serif; font-size: 8pt;">
                <tbody>
                    <tr>
                        <td colspan="3"><strong>Nota:</strong> Información preliminar a partir de Enero de 2008.</td>
                    </tr>
                    <tr>
                        <td colspan="3"><strong>Nota:</strong> La agrupación presentada obedece al Sistema de Clasificación Industrial de América del Norte, México (SCIAN 2007). La cobertura de los datos a nivel de sector no incluye la totalidad de actividades económicas que se desarrollan dentro de cada uno de ellos; lo anterior se debe a que el diseño de la muestra no consideró al Sector como dominio de estudio. Sin embargo, las actividades consideradas para cada Sector representan alrededor del 80% o más del valor de los ingresos del Sector correspondiente, excepto para los Sectores 53 y 71 donde la cobertura es mayor al 50%.</td>
                    </tr>
                    <tr>
                        <td colspan="3"><a href="http://www.inegi.org.mx/est/contenidos/proyectos/encuestas/establecimientos/terciario/ems/default.aspx" target="_top">www.inegi.org.mx/est/contenidos/proyectos/encuestas/establecimientos/terciario/ems/default.aspx</a></td>
                    </tr>
                </tbody>
            </table>

        </div>
        <table>
            <tr>
                <td align="left" style="font-family: Arial, Helvetica, sans-serif; font-size: 8pt;">
                    <br>
                    <br>
                    <span class="tabla">
                        Para descargar la consulta a un archivo, seleccione el formato y pulse el botón "Exportar"
                    </span>
                    <br>
                    <br>
                </td>
            </tr>
            <tr>
                <td align="left" style="font-family: Arial, Helvetica, sans-serif; font-size: 8pt;">
                    <select name="ddlExportaMinero" id="ddlExportaMinero" style="width: 200px;">
                        <option value="1">Excel 5.0 (.xls)</option>
                    </select>

                    <a href="" id="btnExport"><button>exportar</button></a>

                </td>
            </tr>
        </table>
    </div>
    </div>
<script type="text/javascript">

    $("#btnExport").click(function (e) {
        e.preventDefault();
       
        //getting data from our table
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementById('divCuadro');
        var table_html = table_div.outerHTML.replace(/ /g, '%20');

        var a = document.createElement('a');
        a.href = data_type + ', ' + table_html;
        a.download = 'ems' + '.xls';
        a.click();
    });
</script>